<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<title>Risk Box å³æ™‚äº¤æ˜“é¢¨éšªæƒæé«”é©—</title>

<style>
body{
  font-family: "Microsoft JhengHei", sans-serif;
  background:#0f172a;
  color:#e5e7eb;
  text-align:center;
}
.container{
  max-width:900px;
  margin:auto;
  padding:20px;
}
textarea{
  width:100%;
  height:160px;
  background:#020617;
  color:#e5e7eb;
  border:1px solid #334155;
  padding:10px;
  font-size:14px;
}
button{
  background:#2563eb;
  color:white;
  border:none;
  padding:10px 18px;
  margin:6px;
  font-size:14px;
  cursor:pointer;
  border-radius:6px;
}
button:hover{
  background:#1d4ed8;
}
.card{
  background:#020617;
  padding:15px;
  margin-top:15px;
  border-radius:8px;
  border:1px solid #334155;
}
.riskLow{color:#22c55e;}
.riskMid{color:#f59e0b;}
.riskHigh{color:#ef4444;}
.footer{
  margin-top:30px;
  color:#94a3b8;
  font-size:13px;
}
</style>
</head>

<body>

<div class="container">

<h1>ğŸ›¡ Risk Box å³æ™‚äº¤æ˜“é¢¨éšªæƒæé«”é©—</h1>
<p>æ¨¡æ“¬éŠ€è¡Œç­‰ç´šçš„è©é¨™èˆ‡æ´—éŒ¢é¢¨éšªåµæ¸¬æ©Ÿåˆ¶</p>

<div class="card" style="text-align:left; line-height:1.8;">
<h2>é€™å€‹é é¢åœ¨åšä»€éº¼ï¼Ÿ</h2>
<p>
æœ¬é é¢æ¨¡æ“¬é‡‘èäº¤æ˜“é¢¨æ§å¼•æ“ã€‚
æ‚¨å¯ä»¥è¼‰å…¥æ¸¬è©¦å ´æ™¯æˆ–è‡ªè¡Œè¼¸å…¥äº¤æ˜“æµï¼Œ
ç³»çµ±å°‡å³æ™‚è¨ˆç®—é¢¨éšªæŒ‡æ•¸ä¸¦é¡¯ç¤ºåµæ¸¬çµæœã€‚
</p>
<p style="color:#94a3b8;">
æ‰€æœ‰è³‡æ–™åƒ…æ–¼ç€è¦½å™¨æœ¬åœ°åˆ†æï¼Œä¸æœƒä¸Šå‚³æˆ–å„²å­˜ã€‚
</p>
</div>

<h3>ğŸ“Œ æ¸¬è©¦å ´æ™¯</h3>

<button onclick="loadScenario('normal')">æ­£å¸¸æ—¥å¸¸äº¤æ˜“</button>
<button onclick="loadScenario('mule')">äººé ­å¸³æˆ¶æ´—éŒ¢éˆ</button>
<button onclick="loadScenario('atm')">ATM å”åŒæé ˜æ”»æ“Š</button>
<button onclick="startDemo()">â–¶ è‡ªå‹•ç¤ºç¯„æ¨¡å¼</button>
<button onclick="stopDemo()">â¹ åœæ­¢ç¤ºç¯„</button>

<textarea id="input"></textarea>

<br>
<button onclick="scan()">é–‹å§‹æƒæ</button>

<div class="card">
<h2>é¢¨éšªæŒ‡æ•¸</h2>
<h1 id="score">--</h1>
</div>

<div class="card">
<h2>ç³»çµ±ä¿¡å¿ƒæŒ‡æ•¸</h2>
<h3 id="confidence">--</h3>
</div>

<div class="card">
<h2>åµæ¸¬çµæœ</h2>
<div id="results"></div>
</div>

<div class="footer">
Risk Box Simulator ï½œ é‡‘èäº¤æ˜“é¢¨éšªå¯è¦–åŒ–å±•ç¤º
</div>

</div>

<script>

let demoInterval;

const scenarios = {
normal: [
"A001 -> B100 1200",
"A002 -> C200 800",
"A003 -> D300 2200"
],
mule: [
"A001 -> B889 3200",
"A001 -> C231 48000",
"C231 -> D552 49000",
"D552 -> E901 49000"
],
atm: [
"ATM_Taipei -> A778 30000",
"ATM_Taichung -> A778 30000",
"ATM_Kaohsiung -> A778 30000"
]
};

function loadScenario(type){
  document.getElementById("input").value =
    scenarios[type].join("\n");
}

function startDemo(){
  stopDemo();
  const demoData = scenarios.mule;
  let index = 0;
  document.getElementById("input").value = "";

  demoInterval = setInterval(()=>{
    if(index < demoData.length){
      document.getElementById("input").value += demoData[index] + "\n";
      index++;
    } else {
      clearInterval(demoInterval);
      scan();
    }
  }, 800);
}

function stopDemo(){
  clearInterval(demoInterval);
}

function scan(){
  const text = document.getElementById("input").value;
  const lines = text.split("\n");

  let highRisk = 0;
  let mulePattern = false;
  let multiATM = 0;
  let destinationMap = {};

  lines.forEach(line=>{
    if(line.includes("49000")) highRisk++;
    if(line.includes("ATM")) multiATM++;

    const parts = line.split("->");
    if(parts.length>1){
      let dest = parts[1].trim().split(" ")[0];
      destinationMap[dest] = (destinationMap[dest] || 0) + 1;
      if(destinationMap[dest] > 2) mulePattern = true;
    }
  });

  let score = Math.min(100, highRisk*20 + multiATM*15 + (mulePattern?30:0));
  let confidence = 60 + score/2;

  document.getElementById("score").innerHTML =
    `<span class="${score>60?'riskHigh':score>30?'riskMid':'riskLow'}">${score}</span>`;

  document.getElementById("confidence").innerHTML =
    confidence.toFixed(1) + "%";

  let results = "";

  if(score < 30){
    results += "<p class='riskLow'>âœ” äº¤æ˜“è¡Œç‚ºæ­£å¸¸</p>";
  }
  if(highRisk > 0){
    results += "<p class='riskMid'>âš  åµæ¸¬åˆ°é«˜é¡ç•°å¸¸äº¤æ˜“</p>";
  }
  if(mulePattern){
    results += "<p class='riskHigh'>ğŸš¨ ç–‘ä¼¼äººé ­å¸³æˆ¶æ´—éŒ¢ç¶²çµ¡</p>";
  }
  if(multiATM >= 3){
    results += "<p class='riskHigh'>ğŸš¨ åµæ¸¬åˆ°å¤šåœ°ATMå”åŒæé ˜</p>";
  }
  if(score > 70){
    results += "<p class='riskHigh'>â›” å»ºè­°ç«‹å³ä»‹å…¥èˆ‡é˜»æ“‹äº¤æ˜“</p>";
  }

  document.getElementById("results").innerHTML = results;
}

window.onload = function(){
  startDemo();
};

</script>

</body>
</html>
